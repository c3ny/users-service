{"version":3,"sources":["/Users/ysraelmoreno/Documents/codes/fatec/sangue-solidario/users-service/src/application/ports/in/user/createUser.useCase.ts"],"sourcesContent":["import { Inject, Injectable } from '@nestjs/common';\nimport { User } from '@/application/core/domain/user.entity';\nimport { UserRepositoryPort } from '../../out/users-repository.port';\nimport { USERS_REPOSITORY } from '@/constants';\nimport { UseCase } from '@/application/types/useCase.types';\nimport { Result, ResultFactory } from '@/application/types/result.types';\nimport { GetUserByEmailUseCase } from './getUserByEmail.useCase';\nimport { ErrorsEnum } from '@/application/core/errors/errors.enum';\n\n@Injectable()\nexport class CreateUserUseCase implements UseCase<User, Promise<Result<User>>> {\n  constructor(\n    @Inject(USERS_REPOSITORY)\n    private readonly usersRepository: UserRepositoryPort,\n    private readonly getUserByEmailUseCase: GetUserByEmailUseCase,\n  ) {}\n\n  async execute(user: Omit<User, 'id'>): Promise<Result<User>> {\n    const existingUser = await this.getUserByEmailUseCase.execute(user.email);\n\n    if (existingUser.isSuccess) {\n      return ResultFactory.failure(ErrorsEnum.UserAlreadyExists);\n    }\n\n    const savedUser = await this.usersRepository.save(user);\n\n    return ResultFactory.success(savedUser);\n  }\n}\n"],"names":["CreateUserUseCase","execute","user","existingUser","getUserByEmailUseCase","email","isSuccess","ResultFactory","failure","ErrorsEnum","UserAlreadyExists","savedUser","usersRepository","save","success"],"mappings":";;;;+BAUaA;;;eAAAA;;;wBAVsB;qCAEA;2BACF;6BAEK;uCACA;4BACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGpB,IAAA,AAAMA,oBAAN,MAAMA;IAOX,MAAMC,QAAQC,IAAsB,EAAyB;QAC3D,MAAMC,eAAe,MAAM,IAAI,CAACC,qBAAqB,CAACH,OAAO,CAACC,KAAKG,KAAK;QAExE,IAAIF,aAAaG,SAAS,EAAE;YAC1B,OAAOC,0BAAa,CAACC,OAAO,CAACC,sBAAU,CAACC,iBAAiB;QAC3D;QAEA,MAAMC,YAAY,MAAM,IAAI,CAACC,eAAe,CAACC,IAAI,CAACX;QAElD,OAAOK,0BAAa,CAACO,OAAO,CAACH;IAC/B;IAhBA,YACE,AACiBC,eAAmC,EACpD,AAAiBR,qBAA4C,CAC7D;;;aAFiBQ,kBAAAA;aACAR,wBAAAA;IAChB;AAaL"}